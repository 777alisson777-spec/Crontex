{% extends "base_app.html" %}
{% load static %}
{% block title %}Produtos{% endblock %}

{% block content %}
<div class="container">
  <div class="cards" style="margin-bottom:16px;">
    <div class="card">
      <div class="card-title">Produtos</div>
      <div class="card-value">{{ page_obj.paginator.count }}</div>
    </div>
  </div>

  <div class="card">
    <div class="actions" style="display:flex; gap:8px; justify-content:space-between; align-items:center;">
      <form method="get" class="card__filter" style="display:flex; gap:8px; align-items:center; margin:0;">
        <input type="search" name="q" value="{{ request.GET.q }}" placeholder="SKU, descrição, NCM, categoria" class="input">
        <button type="submit" class="btn">Buscar</button>
      </form>
      <div>
        <a href="{% url 'catalog:produto_create' %}" class="btn">Novo</a>
        <a href="{% url 'catalog:produto_import' %}" class="btn secondary">Importar</a>
      </div>
    </div>

    <table class="table" style="margin-top:12px;">
      <thead>
        <tr>
          <th>SKU</th><th>Descrição</th><th>Preço</th><th>NCM</th><th>Categoria</th><th>Estoque</th><th></th>
        </tr>
      </thead>
      <tbody>
        {% for o in object_list %}
        <tr>
          <td>{{ o.sku }}</td>
          <td><a class="side-link" href="{% url 'catalog:produto_detail' o.pk %}">{{ o.name }}</a></td>
          <td>{{ o.price }}</td>
          <td>{{ o.ncm }}</td>
          <td>{{ o.product_category }}</td>
          <td>{{ o.stock_qty }}</td>
          <td>
            <a class="side-link" href="{% url 'catalog:produto_update' o.pk %}">Editar</a> ·
            <a class="side-link" href="{% url 'catalog:produto_delete' o.pk %}">Excluir</a>
          </td>
        </tr>
        {% empty %}
        <tr><td colspan="7">Sem registros.</td></tr>
        {% endfor %}
      </tbody>
    </table>

    {% if is_paginated %}
    <div class="pagination" style="margin-top:12px;">
      {% if page_obj.has_previous %}
        <a href="?page={{ page_obj.previous_page_number }}&q={{ request.GET.q }}">«</a>
      {% endif %}
      <span>página {{ page_obj.number }} de {{ page_obj.paginator.num_pages }}</span>
      {% if page_obj.has_next %}
        <a href="?page={{ page_obj.next_page_number }}&q={{ request.GET.q }}">»</a>
      {% endif %}
    </div>
    {% endif %}
  </div>
</div>
{% endblock %}
